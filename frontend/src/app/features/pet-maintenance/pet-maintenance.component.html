<div class="pet-maintenance-container">
  <!-- Header Section -->
  <div class="header-section">
    <div class="header-content">
      <h1 class="page-title">My Pets</h1>
      <p class="page-subtitle">Manage and track your pets' health and wellness</p>
    </div>
    <button mat-raised-button color="accent" (click)="openAddPetDialog()" class="add-pet-btn" [disabled]="isLoading || errorMessage !== null">
      <mat-icon matPrefix>add_circle</mat-icon>
      Add New Pet
    </button>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="error-message-container">
    <mat-card class="error-card">
      <mat-card-content>
        <div class="error-content">
          <mat-icon class="error-icon">error_outline</mat-icon>
          <div class="error-text">
            <p class="error-title">Connection Error</p>
            <p class="error-description">{{ errorMessage }}</p>
            <button mat-stroked-button color="accent" (click)="loadPets()" class="retry-btn">
              <mat-icon>refresh</mat-icon>
              Retry
            </button>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Main Content Grid -->
  <div class="content-grid" *ngIf="!errorMessage">
    <!-- Left Panel: Pets List -->
    <div class="pets-list-panel">
      <mat-card class="search-card">
        <mat-form-field appearance="outline" class="search-field">
          <mat-label>Search Pets</mat-label>
          <input matInput (keyup)="applyFilter($event)" placeholder="Name or type..." [disabled]="isLoading" />
          <mat-icon matPrefix>search</mat-icon>
        </mat-form-field>
      </mat-card>

      <!-- Pets Grid/List -->
      <div class="pets-scroll-container">
        <div *ngIf="isLoading" class="loading-state">
          <mat-icon class="loading-spinner">autorenew</mat-icon>
          <p>Loading your pets...</p>
        </div>

        <div *ngIf="!isLoading && dataSource.data.length === 0" class="empty-state">
          <mat-icon class="empty-icon">pets</mat-icon>
          <p>No pets yet. Add your first pet to get started!</p>
        </div>

        <div class="pets-grid" *ngIf="!isLoading">
          <mat-card
            *ngFor="let pet of dataSource.data"
            class="pet-card"
            [class.selected-pet]="selectedPet?.id === pet.id"
            (click)="selectPet(pet)"
            matRipple>
            <mat-card-header>
              <div mat-card-avatar class="pet-avatar">
                {{ pet.name.charAt(0).toUpperCase() }}
              </div>
              <mat-card-title>{{ pet.name }}</mat-card-title>
              <mat-card-subtitle>{{ pet.species }}</mat-card-subtitle>
            </mat-card-header>
            <mat-card-content class="pet-info">
              <div class="info-row">
                <span class="info-label">Breed:</span>
                <span class="info-value">{{ pet.breed }}</span>
              </div>
              <div class="info-row">
                <span class="info-label">Born:</span>
                <span class="info-value">{{ pet.birthday }}</span>
              </div>
            </mat-card-content>
          </mat-card>
        </div>
      </div>
    </div>

    <!-- Right Panel: Details & Illustration -->
    <div class="pet-detail-panel">
      <div *ngIf="selectedPet; else noSelection" class="detail-content">
        <!-- Pet Illustration -->
        <div class="illustration-container">
          <svg-pet-illustration [petType]="selectedPet.species"></svg-pet-illustration>
        </div>

        <!-- Pet Details Card -->
        <mat-card class="detail-card">
          <mat-card-header>
            <h2>{{ selectedPet.name }} Details</h2>
          </mat-card-header>

          <mat-card-content>
            <div class="details-grid">
              <!-- Basic Info -->
              <div class="detail-section">
                <h3 class="section-title">
                  <mat-icon>info</mat-icon>
                  Basic Information
                </h3>
                <div class="detail-item">
                  <span class="detail-label">Species:</span>
                  <span class="detail-value">{{ selectedPet.species }}</span>
                </div>
                <div class="detail-item">
                  <span class="detail-label">Breed:</span>
                  <span class="detail-value">{{ selectedPet.breed }}</span>
                </div>
                <div class="detail-item">
                  <span class="detail-label">Birthday:</span>
                  <span class="detail-value">{{ selectedPet.birthday }}</span>
                </div>
              </div>

              <!-- Maintenance Schedule -->
              <div class="detail-section">
                <h3 class="section-title">
                  <mat-icon>schedule</mat-icon>
                  Care & Maintenance
                </h3>
                <div class="maintenance-items">
                  <button mat-stroked-button class="maintenance-btn">
                    <mat-icon>cut</mat-icon>
                    Schedule Grooming
                  </button>
                  <button mat-stroked-button class="maintenance-btn">
                    <mat-icon>veterinary_clinic</mat-icon>
                    Schedule Vet Visit
                  </button>
                  <button mat-stroked-button class="maintenance-btn">
                    <mat-icon>directions_run</mat-icon>
                    Log Exercise
                  </button>
                </div>
              </div>
            </div>
          </mat-card-content>

          <!-- Action Buttons -->
          <mat-card-actions class="detail-actions">
            <button mat-raised-button color="primary">
              <mat-icon>edit</mat-icon>
              Edit Details
            </button>
            <button mat-raised-button color="warn">
              <mat-icon>delete</mat-icon>
              Delete Pet
            </button>
          </mat-card-actions>
        </mat-card>
      </div>

      <!-- No Selection State -->
      <ng-template #noSelection>
        <div class="no-selection-state">
          <svg class="welcome-illustration" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
            <!-- Cute pet welcome illustration -->
            <circle cx="100" cy="80" r="40" fill="#E3F2FD" stroke="#1976D2" stroke-width="2"/>
            <circle cx="85" cy="65" r="5" fill="#1976D2"/>
            <circle cx="115" cy="65" r="5" fill="#1976D2"/>
            <path d="M 95 85 Q 100 92 105 85" stroke="#1976D2" stroke-width="2" fill="none"/>
            <path d="M 70 60 Q 60 50 55 65" stroke="#FF5722" stroke-width="3" fill="none" stroke-linecap="round"/>
            <path d="M 130 60 Q 140 50 145 65" stroke="#FF5722" stroke-width="3" fill="none" stroke-linecap="round"/>
            <circle cx="70" cy="140" r="8" fill="#4CAF50"/>
            <circle cx="100" cy="155" r="8" fill="#4CAF50"/>
            <circle cx="130" cy="140" r="8" fill="#4CAF50"/>
          </svg>
          <h2>Select a Pet</h2>
          <p>Choose a pet from the list to view details and manage care schedules</p>
        </div>
      </ng-template>
    </div>
  </div>
</div>